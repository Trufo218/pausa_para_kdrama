<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gestión de Usuarios - Admin</title>

    <link rel="stylesheet" href="./css/general.css" />
    <link rel="stylesheet" href="./css/admin.css" />
  </head>
  <body>
    <header>
      <p class="posNombreWeb">Pausa Para K-Dramas - Admin</p>
      <nav class="posBtnLoginRegistro">
        <ul>
          <li><a href="admin.html">Inicio Admin</a></li>
          <li><a href="gestion_contenido.html">Gestión de Contenido</a></li>
          <li><a href="index.html">Salir</a></li>
        </ul>
      </nav>
    </header>

    <main>
      <h1>Gestión de Usuarios</h1>

      <div style="margin: 18px 0">
        <button id="btnAbrirCrear" class="btn">➕ Crear usuario</button>
      </div>

      <table class="tabla-usuarios" id="tablaUsuarios">
        <thead>
          <tr>
            <th>ID</th>
            <th>UID Firebase</th>
            <th>Nombre</th>
            <th>Email</th>
            <th>Roles</th>
            <th>Fecha registro</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </main>

    <!-- Modal Crear / Editar -->
    <div id="modal" class="modal" aria-hidden="true">
      <div class="contenido" role="dialog" aria-modal="true">
        <h2 id="modalTitle">Crear usuario</h2>

        <form id="formUsuario" novalidate>
          <input type="hidden" id="localId" />

          <div class="campo">
            <label for="firebaseUid">UID Firebase (solo para edición)</label>
            <input
              id="firebaseUid"
              type="text"
              placeholder="(autogenerado al crear en Firebase)"
              readonly
            />
            <span class="error" id="error-firebaseUid"></span>
          </div>

          <div class="campo">
            <label for="nombre">Nombre</label>
            <input id="nombre" type="text" required />
            <span class="error" id="error-nombre"></span>
          </div>

          <div class="campo">
            <label for="email">Email</label>
            <input id="email" type="email" required />
            <span class="error" id="error-email"></span>
          </div>

          <div class="campo" id="crearPasswordGroup">
            <label for="password">Contraseña (para Firebase)</label>
            <input
              id="password"
              type="password"
              placeholder="min. 6 caracteres"
            />
            <div class="small-muted">
              La contraseña se usa solo al crear el usuario en Firebase.
            </div>
            <span class="error" id="error-password"></span>
          </div>

          <div class="campo">
            <label for="foto">Foto (URL)</label>
            <input id="foto" type="text" placeholder="https://..." />
            <span class="error" id="error-foto"></span>
          </div>

          <div class="campo">
            <label for="roles">Rol</label>
            <select id="roles">
              <option value="USER">USER</option>
              <option value="ADMIN">ADMIN</option>
            </select>
            <span class="error" id="error-roles"></span>
          </div>

          <div class="botones">
            <button
              type="button"
              id="btnCancelar"
              class="btn-secundario"
            >
              Cancelar
            </button>
            <button type="submit" id="btnGuardar" class="btn">
              Guardar
            </button>
          </div>
        </form>
      </div>
    </div>

    <footer>
      <p>&copy; 2025 Pausa Para K-Dramas. Todos los derechos reservados.</p>
    </footer>

    <!-- Firebase (Web SDK v9 compat via namespace) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>

    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyC3mYaJLSEOU6yU3CZBa6uAUUMZrByt224",
        authDomain: "pausaparakdrama.firebaseapp.com",
        projectId: "pausaparakdrama",
        storageBucket: "pausaparakdrama.firebasestorage.app",
        messagingSenderId: "1041723137654",
        appId: "1:1041723137654:web:7b3fac057cb3cf2a6e0957",
        measurementId: "G-D83GTPWEM3",
      };
      firebase.initializeApp(firebaseConfig);
    </script>

    <script src="./js/admin-panel.js"></script>
  </body>
</html>
